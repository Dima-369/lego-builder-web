:root {
    --button-size: calc(max(8vh, 8vw));
}

/* Fixed bottom bar for navigation */
#bottom_panel {
    position: fixed;
    bottom: 0;
    left: 0;
    gap: 70px;
    width: 100%;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: space-between;
    padding: 3%;
    box-sizing: border-box;
    z-index: 20;
    pointer-events: none; /* Allows clicks to pass through empty space */
}

/* Fixed top bar for mobile progress bar */
#top_panel {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 60px; /* Sufficient for progress bar */
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 19; /* Below overlay menus */
    pointer-events: none;
}

/* Allow clicking on actual controls */
.nav_button,
.progress_bar_container {
    pointer-events: auto;
}

/* --- Buttons --- */

#reset_camera_button_wrapper {
    top: 0;
    bottom: 0;
    right: 0;
    position: absolute;
    display: flex;
    align-items: center;
    justify-content: center;
}

.nav_button {
    user-select: none;
    cursor: pointer;
    background-color: #fff;
    border-radius: 20px;
    width: var(--button-size);
    height: var(--button-size);
    box-shadow: 0 4px 2px rgba(0, 0, 0, 0.2);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.1s;
    position: relative; /* Context for children */
}

.nav_button img {
    width: 80%;
    height: 80%;
    pointer-events: none;
}

/* Hide disabled buttons (logic handled in JS) */
.nav_button.hidden {
    visibility: hidden;
    opacity: 0;
    pointer-events: none;
}

/* --- Progress Bar --- */

/* Common styling for both top and bottom progress bars */
.progress_bar_container {
    position: relative;
    cursor: pointer;
    display: flex;
    align-items: center;
    /* Flex grow ensures it fills space between buttons in desktop mode */
    flex-grow: 1;
}

.progress_bar_background {
    position: absolute;
    top: 50%;
    left: -10px;
    transform: translate(0, -50%);
    width: calc(100% + 20px);
    height: calc(max(5vh, 5vw));
    background-color: rgba(0, 0, 0, 0.2);
    border-radius: 30px;
    z-index: 0;
}

.progress_line {
    position: absolute;
    top: 50%;
    left: 0;
    transform: translateY(-50%);
    width: 100%; /* JS sets gradient width */
    height: calc(max(3vh, 3vw));
    border-radius: 20px;
    z-index: 1;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    /* Background is set via inline style (gradient) in JS */
}

.progress_dot {
    position: absolute;
    z-index: 2;
    width: calc(max(6vw, 6vh));
    height: calc(max(6vw, 6vh));
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: #fdc700; /* Lego Yellow */
    border-radius: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    left: 0%; /* JS updates this */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
    pointer-events: none;
}

.progress_dot img {
    width: 70%;
    height: 70%;
}

/* --- Responsive Logic --- */

/* Desktop: Hide Top Bar, Show Bottom Progress */
@media screen and (min-width: 641px) {
    #top_panel {
        display: none;
    }
}

/* Mobile: Hide Bottom Progress, Show Top Bar */
@media screen and (max-width: 640px) {
    #bottom_panel {
        /* On mobile, buttons stick to edges, no middle gap needed */
        justify-content: space-between;
    }

    /* Hide the progress bar that is inside the bottom panel */
    #bottom_panel .progress_bar_container {
        display: none;
    }

    #top_panel {
        display: flex;
        top: 1.5%;
        padding-left: 6%;
        padding-right: 3%;
        min-width: 50vw;
        max-width: calc(100% - (var(--button-size) * 3));
    }

    /* Ensure top progress bar has width */
    #top_panel .progress_bar_container {
        width: 80%;
        margin: 0;
    }
}

/* --- Floating Buttons (Top Right) --- */

#close_button,
#reset_camera_button {
    position: fixed;
    right: 3%;
    width: var(--button-size);
    height: var(--button-size);
    z-index: 30;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
}

#reset_camera_button {
    background-color: #fff;
    border-radius: 50%;
}

#close_button {
    top: 3%;
    border-radius: 20px;
    background-color: rgba(0, 0, 0, 0.2);

    img {
        width: 60%;
        height: 60%;
    }
}

#close_button #reset_camera_button {
    background-color: #fff;
    top: auto; /* Unset top */
    bottom: 25%; /* Position nicely on the right side */
}
#reset_camera_button img {
    width: 50%;
    height: 50%;
}

/* --- Misc --- */
.show-parts #reset_camera_button {
    display: none !important;
}

/* Hide unused elements from original codebase */
#zoom_in_button,
#zoom_out_button,
#stepToContainer,
#numberOfSteps,
#top_buttons {
    display: none !important;
}
